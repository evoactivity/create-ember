function replied(message: string, { stdout, stdin } = process) {
  if (typeof message !== 'string') {
    throw new TypeError(`Expected a string, got ${typeof message}`);
  }

  return new Promise<string>((resolve, reject) => {
    stdin.setEncoding('utf8');
    stdin.setRawMode(true);

    const cleanup = () => {
      stdin.setRawMode(false);
      stdin.pause();
      stdin.removeAllListeners('data');
      stdin.removeAllListeners('error');
    };

    stdin.once('data', (data) => {
      cleanup();
      resolve(data.toString());
    });

    stdin.once('error', (error) => {
      cleanup();
      reject(error);
    });

    stdout.write(message);
  });
}

async function supportsSixel() {
  try {
    const attributes = await replied('\u001B[0c');
    return attributes.includes(';4');
  } catch (_) {
    return false;
  }
}

const logoSixel =
  '\x1BPq"1;1;260;122#0;2;88;28;22#1;2;88;38;31#2;2;88;35;25#3;2;91;47;41#4;2;94;69;66#5;2;97;94;94#6;2;97;97;97#7;2;94;82;78#8;2;91;56;50#9;2;88;41;35#10;2;97;91;88#11;2;94;63;60#12;2;97;85;85#13;2;91;60;56#14;2;94;72;69#15;2;91;50;44#16;2;94;78;75#0!260~-!260~-!135~^NNFFBBB@@@BBFN!110~$#1!135?_!7?AA??C#8G#9O$#2!136?O!8?A$#10!136?_#6_oowww{{{ww_$#4!137?O???C#5C!5?O$#3!138?G?C$#7!139?G!6?C??_-#0!131~NF@#9@#5!5?_?O#7!7?A#0B!108~$#1!131?O?A#3!7?_!8?@#4O$#11!131?_#6_w{}!4~^^N^!6~{#8G$#10!132?OCA@!7?_#12!7?_$#8!132?G#2!9?_!8?C-#0!128~^B!8?_w}~~!9?@!107~$#8!128?_G#14A!8?A#8@#3??G!8?W$#6!129?_w!6~NB@!4?!7~}#1E$!129?C@!7?OC#9???C!8?_$#10!129?OC!6?OC#13!4?@#5!7?@$#4!137?_#11G!4?_$#15!143?Q-#0!126~N@!8?w}~~~^B!9?}!107~$#1!126?OA!9?@#15???_#3C!8?_#1@$#8!126?_C#16@#9!6?_C#10!5?O#7@!7?G$#6!127?o}!6~F@!5?_}!7~B$#12!127?G!7?G#14A!5?G#11!8?O$#13!135?O#12!15?C-#0!125~B!8?o!4~N@!9?o}!108~$#7!125?O@!6?O#10@!4?_G#16@#7!7?OA#2@$#3!125?C#6}!6~N!6?o}!7~N@$#5!125?_#4!7?_!6?C$#11!125?G#2!8?G#8!4?O!9?_C$#14!134?A#1!5?A!9?G$#15!134?C-#0!124~!8?_}~~NB!9?_w!111~$#7!124?O!7?C!4?G#8@#14!7?_GA$#11!124?C!7?G#10???_?A!9?@$#5!124?_#6!7~B!4?o{!7~^F$#9!124?@#3!7?O@??OC#1!9?OC$#15!124?A$#16!124?G-#0!123~@!7?o^NB!9?o{}!33~!5^!75~$#1!123?A!8?_#10_GA!6?_?C@#1!34?_#9_??_$#4!123?_!7?A#11?O#8C@!8?G#11A#3!36?__$#15!123?G!7?C#1!11?_??@$#3!123?C#6!6~N???o{!6~^NB$#13!123?O#12!6?O#2G#14!11?O$#16!130?_#7@-#0!38~^NNFBB!10@BBFFN^!8~^B@@!4?@@F!6~NFFBB!5@B!6~^FBB!6@BN!8~N!8?@#14@#5!6?G#4?A?C#7C#16C#13C#1C??O_#11!18?_!4?A#14??@!7?@#1@???_#9!9?O#6o{{}}}{!6?_ow{{{}{#12O$#1!38?_O??C#16C#2A#13A#14A#7!4?A#4A#15A#8?C#1?GO#2_#9!8?_!8?A_#2!6?OG#16G!7?O#13!6?_#10OG!7?G#6!10?w!5~n_w}!6~frp!6wo_!21?_oow{{}}}!5~}}}{w_#13!10?_#11CA#5A#1@@??G!5?G#7???A#5A$#10!39?_!8?AA!4?C?GO_#6!10?_{{!4}{w!8?_oww!4{w!8?_ow!6{o#16!10?@!7?C#2!9?C#0A!5BFNN^!18~^NFB@@!12?@BF^!9~NB@@???@B!4~^FBB!5@B!36~$#6!40?_oww!10{wwo_#1!11?C???@@@??G#8!9?C#10C#3A#4A???G#2!8?C#7C?A#5AA#14A#15?C#5!10?C#10!5?OO!8?OCG!7?O_#13!20?O#8G!4?@#11!10?AC#3G#10!11?G#2!4?@?C!6?C$#12!40?O!6?A??A#10!18?O!6?A#12C!7?_O!8?_#3!10?A!6?_!8?_!7?A!11?C#11!5?G#5!24?G??A??@!5?@#7!4?O#14!17?A#3o!8?A!4?C$#11!41?G#14!27?G#3A!7?O#14!13?AA#5C#1C!7?G!7?A?O!8?O!8?A!41?C#2A?@#4!37?_??C!4?AG$#7!71?A#2@#9!21?A#7!28?A#8!6?G!9?G?@#12!31?C#10!40?OG!6?_$#9!130?C$#13!130?@-#0!34~^FB!9?__ooo_!8?@!6~F#10C#11!8?_!4?G#8A#4@#8!10?O!4?C#5?@!9?O!9?_#6!14~!4^!10~}{o#11_#10!11?_?C!7?O!4?C!9?w#1!7?_!9?_?GA#8@#5!9?O#0!36~$#1!34?_G#10G?@!8?G???G#5O!6?A#16_!7?A!8?O#0}~~NF@#3!11?_#0~~^FB#12!11?_!9?O!14?_#7__#5_#10!10?@#2@#0BN!11~NB@!8?oowwo_!9?!7~^@!9?^F@#10A#12!9?_$#6!35?_o{}!6~^N!5FN!6~{!8?w!8~B!4?ow}!10~!4?_o{}!9~N#0o!8~#7G#16!29?A#3CO#9!11?O#6ow}!6~NF!4BF^!7~!9?_}!7~??_w{!9~N$#14!35?O?A#11!7?_!6?_!6?@#14O!6?_#5!9?C#1@??O#10?C#4!11?G#15??_#1G?@#2!11?G#8!8?@#7!30?G#2!13?C#1A!7?_#16G#2G??G#12G!8?C!8?O#7@#9!7?O_#16O#14C$#13!36?C#2@!9?O???O!8?A#8!6?O@#7!8?G#14???_#7!13?A#14???O?A#3!11?B#11!8?A#14!44?G#8?@#5!8?C#4C#11C#3?O#7_#13!7?@#2!8?A#3!8?N$#4!46?O#13?G#1G#3G!9?C#9!6?G#12!27?@#10!4?G#9!12?C#14!8?C!68?A#4!8?G$#13!60?G#16!34?C#15!104?C-#0!32~N@!9?o{!6~N!8?o!5~@#12@!8?G#0[FB#3@#7!12?_A#10_??@#5!12?_#2O!8?@#6!9~NF@@!8?@F!9~{!9?o{!7~N@!8?o!6~N!8?w!9~w}~~~N^!7~#14[#0!36~$#1!32?OA!9?GA!6?O#10O!6?O!6?_#14!9?O#1_G#10GA#0!13?_NB@#4!14?A!8?O#10!9?O?A!8?@A#7G!9?@#0B!7~NB!9?o{!6~N!8?o!6~F#12C#1!9?B#14@#7???O!8?@$#8!32?_C#14@!7?O!9?G#8!6?_#13C!5?G!9?_#9A#11O#8C#2!14?O#8O#1C#11A#13!14?C!8?G#8!9?_#0ow{}}!4~}{w#13O#5!9?A#1w!7?O#14G!8?O!8?_!7?_#15G!7?@!14?_#10_#16!7?a$#6!33?o}!7~N@!8?_!6~N!7?}!8~F?_o{!12~^@?o{}!12~^#16@!8?_#11!10?G??@#2@!5?A!12?C#8!7?_?@#15!7?_#11C@!7?A#5!6?O#7A#2!6?G$#12!33?G#15!8?_!9?D#16!7?@!5?O#15!10?@#3!16?G#16?G#0!15?_!8~#9A!11?CA!9?_#3!19?C#10A!8?A#9!7?O#4D!7?C!7?A!9?C$#11!43?C!7?_#3A#4!7?A#2!5?A#4!27?C#3!17?G#15!8?C#3!19?@?C#1!30?GA#12!7?G#10!7?@#3!6?O$#5!43?A#7@#9!15?G#3!5?C#13!131?_-#0!21~NFFNN!5^B#7!9?_!5?G#13C#5?A#12!4?O!9?O#3!10?@!7?O!8?A#11@#8!5?OC#5_#7!8?@!9?@!8?A#1@#2!12?P!9?_#0!7~B#16@#10!8?_!7?C!7?C#11A#2!7?C#12A#10!13?G@!9?@G#12O#3O#1?O???G?C???@?A$#10!21?_O??_!6?A#12!8?A?_#9O!4?A#15@#2!5?O!8?@#9!10?A#14@!6?A#7!8?C#1!6?_#0w!9?_!8~B!9?o}!12~M#6p!8~@!8?{!8~@???__oow{!4~^FB@!8?{!13~F???N!6~}o!7_ooww{{}{#12_$#1!21?O???O??___#16_@!8?C#0]^NNFFB@!5?__w{!6~#13C#12!10?C#10!5?OC?A!8?A!4?_GA]#9!8?O!8?G!9?G!13?_#5I!8?A!8?A#14!8?C_#12_#5_???G?A!5?G#3!9?G#16@#4!13?O??A#7O#13!7?C!5?O#7O???C#8A#5A#10?AW$#6!22?_o_!7?{!8~@??__oow{{~~~^NFB!7?_!10~w}!4~NB@|!7~w{!4~^F@@!8~#11C#13!8?_!9?C#10!14?C#7!8?C!7?_!9?A!4?O#9?C#1A!7?G?@#4!6?_#1!14?_#0w~o!8?@F!6NFFBB@@?@@!19~$#2!22?GG!7?C#11!9?W#14_??O!8?_?G#11C#3A!6?A#8!16?_?_#13!8?@#15!17?G#2!8?C#6{!7~N@#4!23?G!7?O#11!9?W#0]^NNNFB@!6?_o{}!6~B#3!15?C#2?G!8?AG?O#9?O#4???G#16!6?C$#14!24?O#13?_!4?O#2!10?@#1???G#10!11?@#16!6?G#0!17?_#1K#16!26?A#3!8?O#5A#10!7?O#15!24?O#9!7?C#2!10?@?O#13O?G#8??@!4?_#15O#13!9?O#14!15?A#15?C#11_$#3!27?_???G#2!51?O#16!45?_#13!32?G#16!52?@$#11!83?G-#0!20~_#1_#7!22?_#8_?O#12G#3G??A#11@!7?_??C#7!14?_!4?C#14!12?_?@#7!10?A!9?C#11!7?_#3A#1!12?_#3G!8?O???O#13?G#2C#16C#15A#7!14?_???G#4?C#2C#5@!8?_???C#7!12?G!6?AG#5O_#7!12?_?O#9O??C#1A$#6!20?C^^^!20~^^NNFFB@@#1!9?O#6_o!14~^F???o!12~NB???!8~#11o#2!8?O#6o!7~F#13@#14!13?OA!7?G#7@?_?O!4?@#3!14?_?O?G???@#13!6?_#6?_oww!12~F!6?@FN^!12~^^NNFB@#14@$#7!20?A??_#0!22?__ooww{}!6~^^NN#9@#0!15?_w}^#16A#10!12?O#0o{~~!9?!8~N!9?{!12~^F!8?_w^^NNFBB@!16?__ooww{}!6~^NNFB#7A#8!12?OA#3!5?C#9?_#3!14?_#0__oow{!19~$#8!20?P?_#10!23?O#16???C#2C!8?_#5?_#7O#14G#1!15?OC@_#7!14?C#1A#12!10?@#9!8?_#16A!7?O#5!14?_#6w!6~^F???__oow{}!13~^^NNFFB@#1A!8?O#12O#4G#8C#16@#2!12?_#0w!4~}w_#4!18?G#10CA$#5!20?G!30?A#15!12?A#14!15?G#10@??G#8!13?G#14!11?K#4!9?@#12!7?G#8!15?@!8?A#5!5?G#12!18?O#10!4?A#1!27?C!4?@?O#2!19?G$#11!81?A??@#5!35?G#10!23?C!6?_#1?C_#12!56?@-#0!24~!5}{{o#4O!9?A!7?O#10!9?@#14!16?O!5?_#12!11?O!6?_#16!7?A?O#12O#2G?C#4C#13A@!8?@#0^^!5~^^NFB@#11@#7!8?A#3@!9?_#11_#5!9?B!4?O???O#9G#3??C???@#10!16?_C#15A#1!10?@#10@#6!8@#5@$#2!24?@!4?A?G#1_#7!9?@!8?O??G?C?A#1!18?_G#8@#3???@#4!11?_#0o}!4~!9?FNNFFBB@#3!9?C!7?_#14_??G#10C!8?A#8@#14?@#12!7?_#11!12?@?G!7?G#14??C?A#0!18?_{!10~}}!8{}}}!27~$#3!25?@!4?AC!11?@???O!7?C?A?@#13!18?C!4?C#10!12?A!5?O#14!7?@#15G#11???G#8!12?O_#1_!7?O??A#10!32?CG!5?O#1!6?A#14!19?G@#3!12?A#11A!7?@$!26?@#7@#5@???G!9?C#0AF!7NFFFBB@@!19?o}~~~#4O#1!12?G#9@#5!4?G!7?C???O?G#10!11?_#6!9?__ow}!7~|{}}!7~^^^!9~{wooo!5_oooww{{}}!15~^B#16!15?A?A#4A#13A#9A??@$#6!29?@@@F!9~wo!8_oooww{{}}!16~N@!5?!11~N@!5?F!7~wo___oow{}!8~#15I#2!10?GC#1!33?AD?G#7?OO!4?G!5?@#3!16?O#7!16?A$#14!31?A#2!11?C!8?G#10!25?A#11!4?G#13!12?C#12!42?O#0!35?AFF!5NFFFBB@@$#16!43?G#1G#14O#13O!6?G#15!29?A$#10!44?O#15???O#8O-#0!33~{wo_#5!20?_#11_#10O!4?G!8?_#1_GA#3!6?O#7_!8?O!9?O#4!13?_#2_#0_o_#1_#14_#5!7?@???@!9?_!8?C#3?C!7?A#11CGO#15_#10!21?_#15_#0__ow_!9?o{!52~$#2!33?A#6@FN^!19~^^NNFFBF!8~^NB!8?^!8~N@!8?N!13~^NNFN^^!7~!5}!9~!4^NNNFFBBB@@!6?BFN^^!20~^^NFFBB^!7~NB#1A$#14!33?@#5A#11GO_#2!21?_#0_oow#4!10?O#0o{!6~_#1!9?_#0o}!6~o#15_#5!14?O#13O#10G#11O#7!10?@@#10@#16!11?_!8?C#8??A?@#7!31?O!4?_#8!7?_G#4@$#15!34?C!25?O#7G#3G?_#14!10?C@!6?F#3!10?G@#2!6?G#13!44?_!5?G#10!5?@!4?@!4?_#1!23?O#3G?O#10!8?O#12C$#14!63?CO#13!18?G#10!10?A#4!7?A#2!45?_!5?G!8?@#5!29?G#13?CG$#14!94?C#8!7?C#0!46?___oooww{{}}~~}{wo_#14!28?C$#16!102?@#7!46?O??G!4?A$#11!150?O#1O-#0!38~}}{{{!6w!5{}}}!8~}{!5w{}!10~}}!6{}!11~}{!6w{{{}}!7~}}!4{!7w!4{!4}!24~}}{{{!11w{{{}}!7~}{!5w{!55~$#1!38?@!8?CC!4?A#10@#4@!9?@#6@!4B@#9A@#2!10?@#12@#6@@@B@@#11@#14!11?@#6@!6B@@@#7@#1@!7?@#14@??A!9?A#13A#5?@#7@#11@#1!25?@?A#8A???C!5?C!6?@#1!7?@?C#8C#14C??@$#10!39?@??A#2C#9C#5!4?A#12A#13?A#11!13?A#2C???C#8!14?A#7A#5A?A#13A#11!13?A???C#8C#9C#5A#4A#3A#6!11?!4@!7B!4@#4!29?@#6@@@!11B@@@#5!10?@#6@BBB@$#3!40?A!4?CC!9?@!11?C#8C#15C#5A@#2!33?C#15C#13C#2!17?A???C!5?C#7!36?A#2C!9?C#7A??@#9!9?A#10A#11??C#2CA$#6!40?@@@!6B!5@#8!73?A!5?C#15C#3!40?C#11?!4C!5?A#3A#12!15?A$#14!41?A!9?A#10!77?A!7?A#13!43?C#9?C$#3!131?CC??C!4?A???@-#0!260~-!260~-!260~-!260B\x1B\\';

export { supportsSixel, logoSixel };
